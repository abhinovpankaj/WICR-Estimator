<UserControl x:Class="WICR_Estimator.Views.HomePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
      xmlns:local="clr-namespace:WICR_Estimator.Views"
      xmlns:conv="clr-namespace:WICR_Estimator.Converters"
      xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions"
      mc:Ignorable="d" d:DesignWidth="1050" d:DesignHeight="800"
      >
    <UserControl.Resources>
        <conv:BoolToVisibilityConverter x:Key="VisibilityConv"/>
        <DataTemplate x:Key="ProjectTemplate">
            <StackPanel Orientation="Horizontal" Background="#00C0E0FF">
                <Image x:Name="tickImage" Source="..\Images\tick.png"
                       Height="25"
                      Visibility="{Binding IsSelectedProject,
                    Converter={StaticResource VisibilityConv}}"/>
                <TextBlock Text="{Binding Path=Name}"
                           FontWeight="SemiBold"
                           FontSize="15"/>
            </StackPanel>
            <!--<DataTemplate.Triggers>
                <DataTrigger
                Binding="{Binding
                    RelativeSource={RelativeSource
                        Mode=FindAncestor,
                        AncestorType={x:Type ListBoxItem}},
                        Path=IsSelected}"
                Value="True">
                    <Setter TargetName="tickImage"
                Property="Visibility"
                Value="Visible"/>
                </DataTrigger>
            </DataTemplate.Triggers>-->
        </DataTemplate>
        <Style x:Key="ButtonTemplate" TargetType="Button">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="Height" Value="35"/>
            <Setter Property="Width" Value="170"/>
        </Style>
        <Style TargetType="{x:Type ListViewItem}">
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Foreground" Value="Black"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width=".75*"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width=".65*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <StackPanel Background="AntiqueWhite">
            <TextBlock Text="Projects for Estimates"
                   FontSize="16"
                   Margin="5,5,0,5"
                   FontWeight="Bold"/>
        </StackPanel>

        <ListView HorizontalContentAlignment="Stretch" 
                 Grid.Row="1"
                 BorderBrush="Black"
                 BorderThickness="2,2,2,0"
                 Background="AliceBlue"
                 x:Name="ProjectList"
                 SelectionMode="Multiple"
                 ItemsSource="{Binding Projects}"
                    
                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                 ItemTemplate="{StaticResource ProjectTemplate}">
                 <!--<i:Interaction.Triggers>
                    <i:EventTrigger EventName="SelectionChanged">
                        <ei:ChangePropertyAction 
                            TargetObject="{Binding Mode=OneWay}"
                            PropertyName="SelectedItems"
                            Value="{Binding Path=SelectedItems, 
                            ElementName=ProjectList}"/>
                    </i:EventTrigger>
                </i:Interaction.Triggers>-->
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="IsSelected" Value="{Binding IsSelectedProject}" />
                </Style>
            </ListView.ItemContainerStyle>
            
        </ListView>

        <DataGrid ItemsSource="{Binding SelectedProjects,UpdateSourceTrigger=PropertyChanged}"
                  FontSize="14"
                  HorizontalAlignment="Stretch"
                  VerticalAlignment="Top"
                  Grid.RowSpan="2"
                  CanUserAddRows="False"
                  AutoGenerateColumns="False"
                  Margin="10,2,10,0"
                  Grid.Column="1">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Name" IsReadOnly="True"
                                    Binding="{Binding Name}"/>
                <DataGridTextColumn Header="Metal Cost" 
                                    Binding="{Binding MetalCost}"/>
                <DataGridTextColumn Header ="Slope Cost"
                                    Binding="{Binding SlopeCost}"
                                    IsReadOnly="False"/>
                <DataGridTextColumn Header ="System and Other"
                                    Binding="{Binding SystemNOther}"
                                    IsReadOnly="False"/>
                <DataGridTextColumn Header ="Sub Contract Cost" 
                                    Binding="{Binding SubContractCost}"
                                    IsReadOnly="False"/>
                <DataGridTextColumn Header ="Labor Cost" 
                                    Binding="{Binding LaborCost}"
                                    IsReadOnly="False"/>
                <DataGridTextColumn Header ="Material Cost" 
                                    Binding="{Binding MaterialCost}"
                                    IsReadOnly="False"/>
                <DataGridTextColumn Header ="Labor %" 
                                    Binding="{Binding LaborPercentage}"
                                    IsReadOnly="False"/>
                <DataGridTextColumn Header ="Total Cost" 
                                    Binding="{Binding TotalCost}"
                                    IsReadOnly="False"/>
                
            </DataGrid.Columns>
            <!--<i:Interaction.Triggers>
                <i:EventTrigger EventName="SelectionChanged">
                    <i:InvokeCommandAction Command="{Binding ChangePageCommand}" 
                            CommandParameter="{Binding Path=SelectedItem,
                        RelativeSource={RelativeSource Mode=FindAncestor,
                        AncestorType=DataGrid}}" />
                </i:EventTrigger>
            </i:Interaction.Triggers>-->
        </DataGrid>
        <StackPanel Grid.Column="2"
                    Grid.RowSpan="2">
            <TextBlock Text="Project Name" 
                       FontSize="14"
                       Margin="5,5,5,0"/>
            <TextBox Margin="5,0,5,0"
                     FontSize="14"/>
            <TextBlock Text="Prepared By" Margin="5,5,5,0"
                       FontSize="14"/>
            <TextBox Margin="5,0,5,10"
                     FontSize="14"/>
            <Button Content="Load Estimate" Margin="5" 
                    Style="{StaticResource ButtonTemplate}"/>
            <Button Content="Save Estimate" 
                    Style="{StaticResource ButtonTemplate}"/>
            <Button Content="Create Estimate"
                    Style="{StaticResource ButtonTemplate}"/>
            <Button Content="Create Summary Sheet"
                    Style="{StaticResource ButtonTemplate}"/>
            <Button Content="Refresh Google Data"
                    x:Name="refreshGData"
                    Click="refreshGData_Click"
                    Style="{StaticResource ButtonTemplate}"/>
        </StackPanel>
    </Grid>
</UserControl>
